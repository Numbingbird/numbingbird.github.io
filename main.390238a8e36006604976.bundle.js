/*! For license information please see main.390238a8e36006604976.bundle.js.LICENSE.txt */
(()=>{var t,e={464:(t,e,i)=>{"use strict";i(260);class s extends Phaser.Physics.Arcade.Sprite{constructor(t,e,i){super(t,e,i,"ball"),this.name="ball",t.add.existing(this),t.physics.add.existing(this),t.anims.create({key:"roll",frames:t.anims.generateFrameNumbers("ball",{start:0,end:11}),frameRate:24,yoyo:!1,repeat:-1}),this.play("roll"),this.scaleX=this.scale,this.scaleY=this.scale}update(){super.update}SetRandomPosition(){this.setRandomPosition()}}class h extends Phaser.Physics.Arcade.Sprite{constructor(t,e,i,s,h){super(t,e,i,"wall"),this.red=16711680,this.blue=255,this.black=0,this.name="staticWall",t.add.existing(this),t.physics.add.staticImage(this),this.scaleX=s,this.scaleY=h}update(){if(super.update,this.growth)return"updown"==this.growthDir&&this.SetSize(this.displayWidth,this.displayHeight+3.6),"leftright"==this.growthDir&&this.SetSize(this.displayWidth+3.6,this.displayHeight),!0}SetSize(t,e){this.setSize(t,e),this.setDisplaySize(t,e)}GetData(){return[this.x,this.y,this.displayWidth,this.displayHeight]}GetBounds(){return this.getBounds()}setGrowth(t){"up"==t&&(this.setOrigin(.5,1),this.growthDir="updown",this.tint=this.red),"down"==t&&(this.growthDir="updown",this.setOrigin(.5,0),this.tint=this.blue),"left"==t&&(this.growthDir="leftright",this.setOrigin(1,.5),this.tint=this.red),"right"==t&&(this.growthDir="leftright",this.setOrigin(0,.5),this.tint=this.blue)}CollideWithWall(){this.tint=this.black,this.growth=!1,this.name="grownWall"}SetColBlack(){this.CollideWithWall()}SetBounds(t){t?(this.SetSize(0,0),this.setOrigin(0,0),this.setPosition(t.x,t.y),this.SetSize(t.width,t.height)):console.log("crash caught")}}class r extends Phaser.Scene{constructor(){super({key:"MainJezzball"}),this.wallScale=.5,this.totalXMovement=0,this.totalYMovement=0,this.lastX=-1,this.lastY=-1}create(){this.devModeCheats=!1,this.screenWidth=this.cameras.main.width,this.screenHeight=this.cameras.main.height,this.growthDir="updown",this.growingWalls={red:null,blue:null},this.gridSize=16,this.lives=3,this.add.image(31,31,"heart").setDepth(10),this.livesDisp=this.add.text(54,5,this.lives,{fontFamily:'serif, Georgia, "Goudy Bookletter 1911", Times',fontSize:"52px",color:"#000000",stroke:"#ffffff",strokeThickness:4}).setDepth(10),this.arrows=this.add.image(31,80,"arrows").setDepth(10),this.input.activePointer,this.input.on("pointerup",((t,e,i)=>{this.PointerUp(t,e,i)})),this.input.on("pointerdown",(t=>{this.PointerDown(t)})),this.PrepLevel(!0)}PrepLevel(t=!1){var e,i,s,h,r,a;t&&(null===(e=this.groupBall)||void 0===e||e.clear(!0,!0),this.CreateBalls(),this.lives=2),this.levelTransition=!1,t&&(this.currLevel=0),this.currLevel++,this.currLevel<50&&this.CreateBall(),this.lives=this.currLevel+1,this.livesDisp.setText(this.lives),null===(i=this.scoreDisp)||void 0===i||i.destroy(),null===(s=this.groupStaticWall)||void 0===s||s.clear(!0,!0),this.growingWalls={red:null,blue:null},this.createStaticWalls(),this.RandomBallInit(),this.SetCollidersSameArray(null===(h=this.groupBall)||void 0===h?void 0:h.getChildren()),this.SetCollidersBetweenArray(null===(r=this.groupBall)||void 0===r?void 0:r.getChildren(),null===(a=this.groupStaticWall)||void 0===a?void 0:a.getChildren());var l=Math.floor(this.screenWidth/this.gridSize),n=Math.floor(this.screenHeight/this.gridSize);this.cache=Array.from({length:l},((t,e)=>Array.from({length:n},((t,e)=>!1)))),this.totalCells=l*n,console.log(l*n),this.cellsFilled=0}CreateBalls(){this.groupBall=this.physics.add.group({defaultKey:"ball",key:"ball",frameQuantity:1,bounceX:1,bounceY:1,mass:1,collideWorldBounds:!0,classType:s})}CreateBall(){var t;null===(t=this.groupBall)||void 0===t||t.create(this.cameras.main.width/2,0,"ball")}RandomBallInit(){var t;(null===(t=this.groupBall)||void 0===t?void 0:t.getChildren()).forEach((t=>{let e=this.devModeCheats?100:150;var i=this.GenBallSpawnPos();t.setPosition(i.x,i.y),t.setVelocity(e*(Math.random()>.5?1:-1),e*(Math.random()>.5?1:-1))}))}GenBallSpawnPos(){for(var t,e={x:0,y:0},i=0;i<50;)if(i++,e.x=Math.random()*this.screenWidth,e.x=this.Clamp(e.x,9,this.screenWidth-9),e.y=Math.random()*this.screenHeight,e.y=this.Clamp(e.y,9,this.screenHeight-9),t=this.MakeBounds(e.x-9,e.y-9,18,18),!this.CompareBoundsAny(t,this.groupStaticWall)&&!this.CompareBoundsAny(t,this.groupBall))return e;return console.log("max loops, no spawn found"),e}Clamp(t,e,i){return Math.min(Math.max(t,e),i)}StopAllBalls(){var t;(null===(t=this.groupBall)||void 0===t?void 0:t.children.entries).forEach((t=>{t.setVelocity(0,0)}))}createStaticWalls(){var t;this.groupStaticWall=this.physics.add.staticGroup({defaultKey:"staticWall",classType:h}),this.gridSize;var e=this.gridSize,i=this.screenHeight,s=this.screenWidth;this.CreateStaticWallBounds(-e,-e,e,i+e),this.CreateStaticWallBounds(s,-e,e,i+e),this.CreateStaticWallBounds(-e,-e,s+e,e),this.CreateStaticWallBounds(-e,i,s+e,e);var r=null===(t=this.groupStaticWall)||void 0===t?void 0:t.getChildren();for(let t=0;t<r.length;t++)r[t].growth=!1,r[t].name="borderWall"}createStaticWallAt(t,e,i,s){var r,a=new h(this,t,e,i,s);return null===(r=this.groupStaticWall)||void 0===r||r.add(a),a}CreateStaticWallBounds(t,e,i,s){var r,a=this.MakeBounds(t,e,i,s),l=new h(this,a.x,a.y,1,1);return null===(r=this.groupStaticWall)||void 0===r||r.add(l),l.SetBounds(a),l.SetColBlack(),l}createWallHelper(t){var e=this.createStaticWallAt(t.x,t.y,this.wallScale,this.wallScale);return e.growth=!0,e.name="growingWall",e}PointerUp(t,e,i){t.getDistance()<1?this.clickAction(this.initialDownPos):this.totalXMovement>this.totalYMovement?(this.growthDir="leftright",this.clickAction(this.initialDownPos),this.arrows.setAngle(-90)):(this.growthDir="updown",this.clickAction(this.initialDownPos),this.arrows.setAngle(0))}PointerDown(t){this.totalXMovement=0,this.totalYMovement=0,this.initialDownPos={x:t.x,y:t.y}}createWall(t){if(!this.growingWalls.red||"growingWall"!==this.growingWalls.red.name&&"growingWall"!==this.growingWalls.blue.name){var e=this.WallSpawnGridPoint(t);if(!this.CheckCacheFilled(e.x,e.y)){this.wallsGrown=0,this.wallDestroyed=!1;var i=this.createWallHelper(e);this.growingWalls.red=i,"updown"==this.growthDir?i.setGrowth("up"):i.setGrowth("left"),i=this.createWallHelper(e),this.growingWalls.blue=i,"updown"==this.growthDir?i.setGrowth("down"):i.setGrowth("right")}}}clickAction(t){this.levelTransition||this.createWall(t)}TrackMovement(){var t=this.input.activePointer;-1==this.lastX&&(this.lastX=t.x),-1==this.lastY&&(this.lastY=t.y),this.totalXMovement+=Math.abs(this.lastX-t.x),this.totalYMovement+=Math.abs(this.lastY-t.y),this.lastX=t.x,this.lastY=t.y,this.totalXMovement>this.totalYMovement?this.arrows.setAngle(-90):this.arrows.setAngle(0)}WallSpawnGridPoint(t){const e="updown"==this.growthDir;return{x:this.GridHelper(t.x,e),y:this.GridHelper(t.y,!e)}}NearestGridPoint(t){return{x:this.GridHelper(t.x,!1),y:this.GridHelper(t.y,!1)}}NearestGridCenterPoint(t){return{x:this.GridHelper(t.x,!0),y:this.GridHelper(t.y,!0)}}GridHelper(t,e=!1){const i=this.gridSize;var s,h=0;return e&&(h=i/2),(s=(s=i*Math.floor((t+i/2)/i))+(Math.sign(t-s)>=0?1:-1)*h)<0&&(s=0),s}AlignBoundsToGrid(t){var e=this.GridHelper(t.x),i=this.GridHelper(t.y);return this.MakeBounds(e,i,this.GridHelper(t.x+t.width)-e,this.GridHelper(t.y+t.height)-i)}SetCollidersSameArray(t){for(let e=0;e<t.length;e++){for(let i=e;i<t.length;i++)this.physics.add.collider(t[e],t[i]);t[e].body.onCollide=!0}}SetCollidersBetweenArray(t,e){for(let i=0;i<t.length;i++)for(let s=0;s<e.length;s++)this.physics.add.collider(t[i],e[s])}SetCollidersToArray(t,e){this.physics.add.collider(t,e)}SetCollidersToArrays(t,e,i){this.physics.add.collider(t,e),this.physics.add.collider(t,i)}collideListener(t,e,i,s){var h,r=!1;"growingWall"===t.name&&(h=t,r=!0),"growingWall"===e.name&&(h=e,r=!0),r&&1==h.growth&&(this.DestroyWall(h),r=!1)}DestroyWall(t,e=!0){t.destroy(),t.name="destroyedWall",this.wallsGrown=-1,this.wallDestroyed=!0,e&&this.CheckLose()}update(){try{this.trycatch()}catch(t){console.log("crash caught",t)}}trycatch(){var t,e;this.TrackMovement();var i=this.growingWalls.red,s=this.growingWalls.blue;if(this.CheckGrowingWalls(i,"red")||this.CheckGrowingWalls(s,"blue")){if(this.wallDestroyed)return;var h=this.GetBoundsCombinationOf(i,s);i.SetBounds(h),s.destroy()}null===(t=this.groupStaticWall)||void 0===t||t.children.entries.forEach((t=>{t.update()})),null===(e=this.groupStaticWall)||void 0===e||e.refresh()}CheckGrowingWalls(t,e){var i,s;if(!t)return!1;if(null==t)return!1;if(!t.growth)return!1;if("growingWall"!=t.name)return!1;let h=t.GetBounds();var r=!1;return(null===(i=this.groupBall)||void 0===i?void 0:i.children.entries).forEach((e=>{if(r)return;let i=e.getBounds();this.CompareBounds(i,h)&&(r=!0,this.collideListener(e,t,1,1))})),!r&&((null===(s=this.groupStaticWall)||void 0===s?void 0:s.children.entries).forEach((e=>{var i;if(e===t)return!1;if(e.growth)return!1;let s=e.GetBounds();this.CompareBounds(s,h)&&(this.ResolveToBlack(t),this.SetCollidersToArray(t,null===(i=this.groupBall)||void 0===i?void 0:i.getChildren()),this.wallsGrown++)})),2==this.wallsGrown||void 0)}ResolveToBlack(t){var e=t.getBounds();if(t.CollideWithWall(),t.SetBounds(this.AlignBoundsToGrid(t.getBounds())),e=t.getBounds(),this.OutsideCacheArrayLengths(e.x/this.gridSize,e.y/this.gridSize))this.DestroyWall(t,!1);else{var i=this.FillCache(t.getBounds());this.CheckExpansion(i)}}FillCache(t){const e=this.gridSize;for(var i=Array(),s=t.x;s<t.x+t.width;s+=e)for(var h=t.y;h<t.y+t.height;h+=e)this.OutsideCacheArrayLengths(s/e,h/e)||(this.cache[s/e][h/e]=!0,this.cellsFilled++,i.push({x:s/e,y:h/e}));return this.CheckLevelWin(),i}CheckCacheFilled(t,e){return t=Math.floor(t/this.gridSize),e=Math.floor(e/this.gridSize),!this.OutsideCacheArrayLengths(t,e)&&this.cache[t][e]}OutsideCacheArrayLengths(t,e){return t<0||e<0||t>=this.cache.length||e>=this.cache[0].length}CheckExpansion(t){var e,i=this.cache.map((t=>t.slice()));[[0,1],[0,-1],[1,0],[-1,0]].forEach((s=>{t.forEach((t=>{var h={x:t.x+s[0],y:t.y+s[1]};if(e={minx:h.x,miny:h.y,maxx:h.x,maxy:h.y},this.FloodFillStart(this.cache,i,h.x,h.y,e),e.minx!=e.maxx||e.miny!=e.maxy){const t=this.gridSize;e.minx*=t,e.miny*=t,e.maxx*=t,e.maxy*=t;var r=this.MakeBounds(e.minx,e.miny,e.maxx-e.minx+t,e.maxy-e.miny+t);this.CompareBoundsAny(r,this.groupBall)||(this.CreateStaticWallBounds(r.x,r.y,r.width,r.height),this.FillCache(r))}}))}))}FloodFillStart(t,e,i,s,h){this.queue=Array(),this.queue.push([i,s]),this.FloodFillQueue(this.cache,e,i,s,h)}FloodFillQueue(t,e,i,s,h){for(;0!=this.queue.length;){var r=this.queue.shift();i=r[0],s=r[1],i<0||s<0||i>=t.length||s>=t[0].length||t[i][s]||e[i][s]||(e[i][s]=!0,this.FloodFillQueueHelp(t,e,i,s,h))}}FloodFillQueueHelp(t,e,i,s,h){this.queue.push([i+1,s]),this.queue.push([i-1,s]),this.queue.push([i,s+1]),this.queue.push([i,s-1]),h.minx=Math.min(i,h.minx),h.miny=Math.min(s,h.miny),h.maxx=Math.max(i,h.maxx),h.maxy=Math.max(s,h.maxy)}CacheDebug(t,e=3){var i=t;if(0==e)for(var s=0;s<i.length;s++)for(var h=0;h<i[0].length;h++)console.log(i[s][h]);if(1==e)for(s=0;s<i[0].length;s++)for(h=0;h<i.length;h++)console.log(i[h][s]);if(2==e&&console.log(this.cache),3==e){var r=Array(),a=Array();for(s=0;s<i[0].length;s++){for(r=Array(),h=0;h<i.length;h++)r.push(i[h][s]?"■":"");a.push(r)}console.log(a)}}CheckLose(){if(this.lives--,this.livesDisp.setText(this.lives),!(this.lives>0||this.lives<0||this.levelTransition)){this.levelTransition=!0,this.scoreDisp=this.add.text(12,120,"Score : "+(this.currLevel*Phaser.Math.Between(1e4,12e3)).toString(),{fontFamily:'Georgia, "Goudy Bookletter 1911", Times, serif',fontSize:"40px",color:"#000000",stroke:"#ffffff",strokeThickness:4}).setDepth(10),this.StopAllBalls();var t=this.add.image(this.screenWidth/2,this.screenHeight/2,"restart").setInteractive();t.once("pointerup",(e=>{this.PrepLevel(!0),t.destroy()}))}}CheckLevelWin(){if(!(this.cellsFilled/this.totalCells<.6||this.levelTransition)){this.levelTransition=!0,this.StopAllBalls();var t=this.add.image(this.screenWidth/2,this.screenHeight/2,"nextLevel").setInteractive();t.once("pointerup",(e=>{this.PrepLevel(),t.destroy()}))}}MakeBounds(t,e,i,s){return{x:t,y:e,width:i,height:s}}GetBoundsCombinationOf(t,e){var i=t.getBounds(),s=e.getBounds(),h=Math.min(i.x,s.x),r=Math.min(i.y,s.y),a=Math.max(i.x+i.width,s.x+s.width),l=Math.max(i.y+i.height,s.y+s.height);return this.MakeBounds(h,r,a-h,l-r)}CompareBounds(t,e,i=!1){return t&&e&&t.width&&t.height&&e.width&&e.height||console.log("bad wall spawn; caught"),i&&(console.log("comparing"),console.log(t),console.log(e),console.log(t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y)),t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}CompareBoundsAny(t,e,i=!1){var s=!1;return(null==e?void 0:e.children.entries).forEach((e=>{if(s)return!0;this.CompareBounds(t,e.getBounds(),i)&&(s=!0)})),s}}class a extends Phaser.Scene{constructor(){super({key:"PreloadJezzball"})}preload(){this.load.image("wall","assets/img/wall.png"),this.load.spritesheet("ball","assets/img/jezzballs.png",{frameHeight:16,frameWidth:16}),this.load.image("heart","assets/img/heart.png"),this.load.image("arrows","assets/img/arrows.png"),this.load.image("restart","assets/img/restart.png"),this.load.image("nextLevel","assets/img/nextLevel.png")}create(){this.scene.start("MainJezzball")}}class l{static Lerp(t,e,i){return(1-i)*t+i*e}static PLerp(t,e,i,s=3){return this.Lerp(t,e,Math.pow(i,s))}static OffsetToScreenSpace(t,e,i){var s=this.OffsetToScreenZ(t);return[this.Lerp(t[0]*e[1]*2,t[0]*e[0]*2,s)+i[0]/2,this.Lerp(t[1]*e[1]*2,t[1]*e[0]*2,s)+i[1]/2]}static OffsetToScreenZ(t){return 2*Math.tan((t[2]+1)/2)/Math.PI}static OffsetToScreenSize(t){return.35*t[2]+.65}static OffsetToScreenLineWidth(t){return.45*t+.55}static Clamp(t,e,i){return Math.min(Math.max(t,e),i)}}class n extends Phaser.Physics.Arcade.Sprite{constructor(t,e,i){super(t,e,i,"ball"),this.name="ball",this.pos=[0,0,0],this.vel=[0,0,0],this.accel=[0,0,0],this.distWall=[0,0,1],this.moving=!1,this.red=16515843,this.green=261144,this.ballRadius=[30,30,0],this.flagCheckGoal=!1,this.flagBeenInBounds=!0,t.add.existing(this),this.PrepStart()}PrepStart(){this.moving=!1,this.pos=[0,0,1],this.vel=[0,0,0],this.accel=[0,0,0],this.tint=this.green}SetDims(t,e,i){this.boxDims=t,this.boxFactors=e,this.screenSize=i,this.distWall[0]=this.boxDims[0],this.distWall[1]=this.boxDims[1]}SetVelZ(t){this.moving=!0,this.vel[2]=t}SetEnd(){this.moving=!1,this.tint=this.red}SetPos(t){this.pos[0]=this.distWall[0],this.pos[1]=this.distWall[1],this.pos[2]=-1}AddVel(t){for(var e=0;e<2;e++)this.vel[e]+=1.3*t[e]}AddAccel(t){for(var e=0;e<2;e++)this.accel[e]*=.5,this.accel[e]+=-.001*t[e]}update(t,e){super.update(),this.PhysicsStep(e);var i=this.pos,s=l.OffsetToScreenSpace(i,this.boxFactors,this.screenSize);this.setPosition(s[0],s[1]);var h=l.OffsetToScreenSize(i)*this.ballRadius[0]*2;this.setDisplaySize(h,h)}PhysicsStep(t){if(this.moving)for(var e=0;e<3;e++)this.vel[e]+=this.accel[e]*t,this.pos[e]+=this.vel[e]*t,Math.abs(this.pos[e])+this.ballRadius[e]>this.distWall[e]?(2==e?this.flagBeenInBounds&&(this.flagBeenInBounds=!1,this.flagCheckGoal=!0):this.accel[e]*=.8,Math.sign(this.vel[e])==Math.sign(this.pos[e])&&(this.vel[e]*=-1)):this.flagBeenInBounds=!0}FlagChecked(){this.flagCheckGoal=!1}}class o extends Phaser.Physics.Arcade.Sprite{constructor(t,e,i){super(t,e,i,"panelB"),this.name="panel",this.pos=[0,0,-1],this.prevPos=[0,0,-1],this.cpu=!1,this.vel=[0,0],this.followPct=5e-4,this.pointerPos=[0,0],t.add.existing(this),this.alpha=.4}SetDims(t,e,i){this.boxDims=t,this.boxFactors=e,this.screenSize=i}SetPlayerStuff(t){this.setTexture("panelA"),this.pos=[0,0,1],this.SetDisplaySize(),this.ball=t}SetCpuStuff(t){this.ball=t,this.cpu=!0,this.SetDisplaySize()}SetDisplaySize(){this.spriteSize=[100,70];var t=l.OffsetToScreenSize(this.pos);this.setDisplaySize(t*this.spriteSize[0],t*this.spriteSize[1])}update(t,e){super.update();var i=this.pos;this.prevPos=[i[0],i[1],i[2]],this.cpu?this.FollowBall(e):this.FollowPointer(e),this.RecordVelocity(e);var s=l.OffsetToScreenSpace(i,this.boxFactors,this.screenSize);this.setPosition(s[0],s[1])}FollowBall(t){var e=this.ball.pos;(this.ball.vel[2]>=0||!this.ball.moving)&&(e=[0,0]);for(var i=0;i<2;i++)this.pos[i]=l.Lerp(this.pos[i],e[i],l.Clamp(this.followPct*t,5e-4,1))}SetFollowPct(t){this.followPct=35e-6*Math.pow(t+2,2)}SetInitPos(){for(var t=0;t<2;t++)this.pointerPos[t]=this.screenSize[t]/2}SetPosition(t){for(var e=[t.x,t.y],i=0;i<2;i++)this.pointerPos[i]=e[i]}FollowPointer(t){for(var e=0;e<2;e++)this.pos[e]=l.Lerp(this.pos[e],this.pointerPos[e]-this.screenSize[e]/2,l.Clamp(.1*t,0,1));this.setPosition(this.pos[0],this.pos[1])}RecordVelocity(t){for(var e=this.vel,i=this.prevPos,s=0;s<2;s++)e[s]=(this.pos[s]-i[s])*t;var h=Math.pow(Math.pow(e[0],2)+Math.pow(e[1],2),.5);if(0!=h)for(h*=1.3,s=0;s<2;s++)e[s]=e[s]/h*l.Clamp(h,0,.2)}}class c extends Phaser.Scene{constructor(){super({key:"MainCurveball"}),this.devModeCheats=!0}create(){this.screenSize=[this.cameras.main.width,this.cameras.main.height],this.lives=3,this.add.image(32,32,"heart").setDepth(10),this.livesDisp=this.AddText(54,5,this.lives),this.add.image(32,80,"speed").setDepth(10),this.speedDisp=this.AddText(54,50,1),this.boxFactors=[.49,.12],this.boxDims=[this.screenSize[0]*this.boxFactors[0],this.screenSize[1]*this.boxFactors[0],this.screenSize[0]*this.boxFactors[1],this.screenSize[1]*this.boxFactors[1]];var t=[this.screenSize[0]/2,this.screenSize[1]/2];this.ball=new n(this,t[0],t[1]).setDepth(1),this.panelA=new o(this,t[0],t[1]).setDepth(2),this.panelB=new o(this,t[0],t[1]),this.ball.SetDims(this.boxDims,this.boxFactors,this.screenSize),this.panelA.SetDims(this.boxDims,this.boxFactors,this.screenSize),this.panelA.SetPlayerStuff(this.ball),this.panelB.SetDims(this.boxDims,this.boxFactors,this.screenSize),this.panelB.SetCpuStuff(this.ball),this.DrawLines(),this.trackingRect=this.add.rectangle(this.screenSize[0]/2,this.screenSize[1]/2,500,500).setOrigin(.5,.5),this.trackingRect.isStroked=!0,this.trackingRect.strokeColor=16777215,this.NextLevel(!0),this.input.activePointer,this.input.on("pointermove",(t=>{this.UpdatePlayerPanel(t),this.StartLevel()})),this.input.on("pointerdown",(t=>{this.StartLevel()}))}AddText(t,e,i){return this.add.text(t,e,i,{fontFamily:'serif, Georgia, "Goudy Bookletter 1911", Times',fontSize:"52px",color:"#000000",stroke:"#ffffff",strokeThickness:4}).setDepth(10)}StartLevelAutoTesting(){this.ball.SetVelZ(-.001)}DrawLines(){for(var t=.1,e=-1;e<1;e+=t)t+=.0335,this.DrawBox(e);this.DrawBox(1);var i=l.OffsetToScreenLineWidth(-1);this.DrawLine(!0,!0,!0,!0,-1,1,i,1),this.DrawLine(!0,!1,!0,!1,-1,1,i,1),this.DrawLine(!1,!0,!1,!0,-1,1,i,1),this.DrawLine(!1,!1,!1,!1,-1,1,i,1)}DrawBox(t){var e=l.OffsetToScreenLineWidth(t);this.DrawLine(!0,!0,!0,!1,t,t,e,e),this.DrawLine(!0,!0,!1,!0,t,t,e,e),this.DrawLine(!1,!1,!0,!1,t,t,e,e),this.DrawLine(!1,!1,!1,!0,t,t,e,e)}DrawLine(t,e,i,s,h,r,a,l){var n=this.DrawLineGetPoint(t,e,h),o=this.DrawLineGetPoint(i,s,r);this.add.line(0,0,n[0],n[1],o[0],o[1],31238).setOrigin(0,0).setLineWidth(a,l)}DrawLineGetPoint(t,e,i){i=.5*i+.5;var s=l.Lerp(this.boxDims[2],this.boxDims[0],i),h=l.Lerp(this.boxDims[3],this.boxDims[1],i),r=this.screenSize[0]/2,a=this.screenSize[1]/2;return t?r-=s:r+=s,e?a-=h:a+=h,[r,a]}UpdatePlayerPanel(t){this.panelA.SetPosition(t)}NextLevel(t=!1){t&&(this.lives=0,this.currLevel=0,this.panelA.SetInitPos()),this.currLevel++,this.currLevel%2&&this.lives++,this.livesDisp.setText(this.lives),this.speedDisp.setText(this.currLevel),this.panelB.SetFollowPct(this.currLevel),this.panelB.SetInitPos(),this.BallToStart(),this.lost=!1,this.levelTransition=!1}BallToStart(){this.levelTransition=!1,this.ball.PrepStart()}StartLevel(){this.ball.moving||this.input.activePointer.isDown&&(this.levelTransition||this.CheckWithinPanel(this.ball,this.panelA)&&(this.ball.SetVelZ(-15e-5*this.currLevel-.001),this.BallHitByPanel(this.panelA)))}update(t,e){try{this.trycatch(t,e)}catch(t){console.log(t)}}trycatch(t,e){this.ball.update(t,e),this.panelA.update(t,e),this.panelB.update(t,e);var i=l.OffsetToScreenZ(this.ball.pos);this.trackingRect.setDisplaySize(l.Lerp(2*this.boxDims[2],2*this.boxDims[0],i),l.Lerp(2*this.boxDims[3],2*this.boxDims[1],i)).lineWidth=l.OffsetToScreenLineWidth(i),this.CheckGoal()}CheckLose(t){if(this.lives--,this.livesDisp.setText(this.lives),!(this.lives>0||this.lives<0||this.lost)){this.lost=!0,t.destroy();var e=this.add.image(this.screenSize[0]/2,this.screenSize[1]/2,"restart").setInteractive().setDepth(10);e.once("pointerup",(t=>{this.NextLevel(!0),e.destroy()}))}}CheckGoal(){if(this.ball.flagCheckGoal&&!this.levelTransition){this.ball.FlagChecked();var t,e=!0;if(this.ball.pos[2]>0?t=this.panelA:(t=this.panelB,e=!1),this.CheckWithinPanel(this.ball,t))this.BallHitByPanel(t);else if(this.ball.SetEnd(),this.levelTransition=!0,e){var i=this.time.delayedCall(1e3,this.BallToStart,Array(),this);this.CheckLose(i)}else i=this.time.delayedCall(1e3,this.NextLevel,Array(),this)}}CheckWithinPanel(t,e){for(var i=t.pos,s=0;s<2;s++)if(!(Math.abs(i[s]-e.pos[s])<e.spriteSize[s]/2+t.ballRadius[s]))return!1;return!0}BallHitByPanel(t){this.ball.AddVel(t.vel),this.ball.AddAccel(t.vel)}}class d extends Phaser.Scene{constructor(){super({key:"PreloadCurveball"})}preload(){this.load.image("wall","assets/img/wall.png"),this.load.image("ball","assets/img/ball.png"),this.load.image("panelA","assets/img/panelA.png"),this.load.image("panelB","assets/img/panelB.png"),this.load.image("heart","assets/img/heart.png"),this.load.image("speed","assets/img/speed.png"),this.load.image("restart","assets/img/restart.png"),this.load.image("nextLevel","assets/img/nextLevel.png")}create(){this.scene.start("MainCurveball")}}class p{static Lerp(t,e,i){return(1-i)*t+i*e}static PLerp(t,e,i,s=3){return this.Lerp(t,e,Math.pow(i,s))}static Clamp(t,e,i){if(e>i){var s=i;i=e,e=s}return Math.min(Math.max(t,e),i)}}class u extends Phaser.Scene{constructor(){super({key:"MainGhostleg"}),this.linesToGen=16,this.polesCount=5,this.maxYDist=70,this.minDistBetweenLines=30,this.playAreaMaxY=1e3,this.nextLevelButtonYOffset=80,this.chanceStraightLine=.8,this.poleYSpacer=70,this.sideSpacer=50,this.lineYSpacer=60,this.devModeCheats=!0,this.currentPhase=-1,this.lineCount=0,this.lineCol=16777215,this.lastY=-1,this.lineWidth=4,this.traceCol=58942}create(){this.screenSize=[this.cameras.main.width,this.cameras.main.height],this.linesDrawn=this.physics.add.group({}),this.polesDrawn=this.physics.add.group({}),this.traceDrawn=this.physics.add.group({}),this.SetBounds(),this.hideScreen=this.add.image(this.screenSize[0]/2,this.playAreaMaxY/2,"wall").setDepth(10).setAlpha(.8).setTint(3355182).setDisplaySize(this.screenSize[0],this.playAreaMaxY-2*(this.poleYSpacer+this.lineYSpacer-this.lineWidth)),this.NextPhase(),this.input.on("pointerdown",(t=>{this.PointerDown()})),this.nextLevelButton=this.add.image(this.screenSize[0]/2+30,this.screenSize[1]-this.nextLevelButtonYOffset,"next").setInteractive().setDepth(10),this.nextLevelButton.on("pointerup",(t=>{this.NextPhase()}))}NextPhase(){switch(this.currentPhase++,this.currentPhase){case 0:this.ResetLines(),this.DrawPoles(),this.CreateLines(this.linesToGen),this.DrawLines(),this.SortLines(),this.HideScreen(!1);break;case 1:this.HideScreen(!0),this.SetStartPole(),this.Scroll(-this.playAreaMaxY);break;case 2:this.HideScreen(!1);var t=this.GeneratePath(this.startPole);this.StrokePath(t),this.currentPhase=-1}}HideScreen(t){var e=t?1:0;this.hideScreen.setAlpha(e)}SetStartPole(){var t;this.startPole=Phaser.Math.Between(0,this.polesCount-1);var e=this.startPole,i=this.add.line(0,0,this.PoleToPos(e),this.poleYSpacer,this.PoleToPos(e),this.poleYSpacer+this.lineYSpacer,this.traceCol).setOrigin(0,0).setLineWidth(this.lineWidth);null===(t=this.traceDrawn)||void 0===t||t.add(i)}ResetLines(){var t,e;null===(t=this.linesDrawn)||void 0===t||t.clear(!0,!0),null===(e=this.traceDrawn)||void 0===e||e.clear(!0,!0),this.linesOrdered=Array();for(var i=0;i<this.polesCount;i++)this.linesOrdered.push(Array())}CreateLines(t){for(var e=0;e<t;e++)this.CreateRandomLine()}CreateRandomLine(){for(var t=0;t<50;t++){var e=this.RandY1(),i=Phaser.Math.Between(0,1)<this.chanceStraightLine?e:this.RandY2(e),s=Phaser.Math.Between(0,this.polesCount-2);if(0!=this.ProposeLine(e,i,s))return this.CreateALine(e,i,s)}return console.log("failed spawn"),-1}RandY1(){return Phaser.Math.Between(this.poleYSpacer+this.lineYSpacer,this.playAreaMaxY-this.lineYSpacer-this.poleYSpacer)}RandY2(t){var e=Phaser.Math.Between(t+this.maxYDist,t-this.maxYDist);return this.ClampToPlayY(e)}ClampToPlayY(t){return p.Clamp(t,this.poleYSpacer+this.lineYSpacer,this.playAreaMaxY-this.lineYSpacer-this.poleYSpacer)}CreateALine(t,e,i){var s={y1:t,y2:e,poleInd:i};return this.linesOrdered[s.poleInd].push(s),this.lineCount++,s}CheckLineValueDist(t,e,i){if(-1==t)return!0;if(t>=this.linesOrdered.length)return!0;if(0==this.linesOrdered[t].length)return!0;for(var s=0;s<this.linesOrdered[t].length;s++){var h;if(h="left"==i?this.linesOrdered[t][s].y1:this.linesOrdered[t][s].y2,Math.abs(h-e)<=this.minDistBetweenLines)return!1}return!0}CheckOverlap(t,e,i){for(var s=0;s<this.linesOrdered[t].length;s++)if(Math.sign(this.linesOrdered[t][s].y1-e)!=Math.sign(this.linesOrdered[t][s].y2-i))return!1;return!0}ProposeLine(t,e,i){var s=this.CheckLineValueDist(i-1,t,"right"),h=this.CheckLineValueDist(i,t,"left"),r=this.CheckLineValueDist(i,e,"right"),a=this.CheckLineValueDist(i+1,e,"left"),l=this.CheckOverlap(i,t,e);return s&&h&&r&&a&&l}DrawPoles(){for(var t,e=0;e<this.polesCount;e++){var i=this.PoleToPos(e),s=this.DrawGhostLegLine(i,this.poleYSpacer,i,this.playAreaMaxY-this.poleYSpacer);null===(t=this.polesDrawn)||void 0===t||t.add(s)}}DrawLines(){var t;null===(t=this.linesOrdered)||void 0===t||t.forEach((t=>{null==t||t.forEach((t=>{this.DrawLine(t)}))}))}DrawLine(t){var e,i=this.PoleToPos(t.poleInd),s=this.PoleToPos(t.poleInd+1),h=this.DrawGhostLegLine(i,t.y1,s,t.y2);null===(e=this.linesDrawn)||void 0===e||e.add(h)}DrawGhostLegLine(t,e,i,s){return this.add.line(0,0,t,e,i,s,this.lineCol).setOrigin(0,0).setLineWidth(this.lineWidth)}PoleToPos(t){var e=this.GetPoleSpacing();return e.sides+t*e.between}GetPoleSpacing(){var t=this.sideSpacer;return{sides:t,between:(this.screenSize[0]-t-t)/(this.polesCount-1)}}SortLines(){for(var t=0;t<this.linesOrdered.length;t++)this.linesOrdered[t].sort(((t,e)=>t.y1-e.y1))}SetBounds(){this.cameras.main.setBounds(0,0,1280,this.playAreaMaxY),this.physics.world.setBounds(0,0,1280,this.playAreaMaxY)}SwipeCamera(){var t=this.input.activePointer;t.isDown&&(-1==this.lastY&&(this.lastY=t.y),this.Scroll(this.lastY-t.y),this.lastY=t.y)}Scroll(t){this.cameras.main.scrollY+=t,this.nextLevelButton.y+=t,this.nextLevelButton.y=p.Clamp(this.nextLevelButton.y,this.screenSize[1]-this.nextLevelButtonYOffset,this.playAreaMaxY-this.nextLevelButtonYOffset)}PointerDown(){this.lastY=this.input.activePointer.y}GetIndexOfNext(t,e,i,s=!1){if(-1==t)return-1;if(t>=this.linesOrdered.length)return-1;if(0==this.linesOrdered[t].length)return-1;for(var h=0;h<this.linesOrdered[t].length;h++)if(("left"==i?this.linesOrdered[t][h].y1:this.linesOrdered[t][h].y2)>e)return s?h-1:h;return s?this.linesOrdered[t].length-1:-1}GeneratePath(t){var e=Array();e.push({x:this.PoleToPos(t),y:this.poleYSpacer});for(var i=t,s=0,h=0;s<this.playAreaMaxY;){if(++h>50){console.log("overloop");break}var r=this.GetIndexOfNext(i-1,s,"right"),a=this.GetIndexOfNext(i,s,"left");if(-1==r&&-1==a)break;var l=0;if(-1==r?l=2:-1==a&&(l=1),0==l){var n=this.linesOrdered[i-1][r],o=this.linesOrdered[i][a];l=n.y2>o.y1?2:1}else 1==l?n=this.linesOrdered[i-1][r]:o=this.linesOrdered[i][a];1==l?(e.push({x:this.PoleToPos(i),y:n.y2}),i--,e.push({x:this.PoleToPos(i),y:n.y1}),s=n.y1):(e.push({x:this.PoleToPos(i),y:o.y1}),i++,e.push({x:this.PoleToPos(i),y:o.y2}),s=o.y2)}return e.push({x:this.PoleToPos(i),y:this.playAreaMaxY-this.poleYSpacer}),e}StrokePath(t){for(var e,i=this.traceCol,s=0;s<t.length-1;s++){var h=this.add.line(0,0,t[s].x,t[s].y,t[s+1].x,t[s+1].y,i).setOrigin(0,0).setLineWidth(this.lineWidth);null===(e=this.traceDrawn)||void 0===e||e.add(h)}}update(t,e){try{this.trycatch(t,e)}catch(t){console.log(t)}}trycatch(t,e){this.SwipeCamera()}}class g extends Phaser.Scene{constructor(){super({key:"PreloadGhostleg"})}preload(){this.load.image("wall","assets/img/wall.png"),this.load.image("next","assets/img/next.png")}create(){this.scene.start("MainGhostleg")}}class v extends Phaser.Scene{constructor(){super({key:"SceneSelect"}),this.itemsCount=3}create(){this.screenSize=[this.cameras.main.width,this.cameras.main.height],this.itemSize=this.screenSize[1]/(this.itemsCount+1),this.itemSpacer=this.screenSize[1]/(this.itemsCount+1),this.CreateSSIcon(0,"jezzball","PreloadJezzball"),this.CreateSSIcon(1,"curveball","PreloadCurveball"),this.CreateSSIcon(2,"ghostleg","PreloadGhostleg")}CreateSSIcon(t,e,i){var s=this.itemSize,h=this.add.image(this.screenSize[0]/2,this.IndToPos(t),e).setInteractive().setDepth(10).setDisplaySize(s,s);h.once("pointerup",(t=>{this.scene.start(i),h.destroy()}))}IndToPos(t){var e=t-(this.itemsCount-1)/2,i=this.itemSpacer;return this.screenSize[1]/2+i*e}update(t,e){try{this.trycatch(t,e)}catch(t){console.log(t)}}trycatch(t,e){}}class S extends Phaser.Scene{constructor(){super({key:"PreloadSceneSelect"})}preload(){this.load.image("ghostleg","assets/img/ghostleg.png"),this.load.image("curveball","assets/img/curveball.png"),this.load.image("jezzball","assets/img/jezzball.png")}create(){this.scene.start("SceneSelect")}}const m={type:Phaser.AUTO,backgroundColor:"#33322e",scale:{parent:"phaser-game",mode:Phaser.Scale.NONE,autoCenter:Phaser.Scale.CENTER_BOTH,width:window.innerWidth,height:window.innerHeight},scene:[S,v,g,u,d,c,a,r],physics:{default:"arcade",arcade:{debug:!1}},pixelArt:!1};window.addEventListener("load",(()=>{new Phaser.Game(m)}))},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},i={};function s(t){var h=i[t];if(void 0!==h)return h.exports;var r=i[t]={exports:{}};return e[t].call(r.exports,r,r.exports,s),r.exports}s.m=e,t=[],s.O=(e,i,h,r)=>{if(!i){var a=1/0;for(c=0;c<t.length;c++){for(var[i,h,r]=t[c],l=!0,n=0;n<i.length;n++)(!1&r||a>=r)&&Object.keys(s.O).every((t=>s.O[t](i[n])))?i.splice(n--,1):(l=!1,r<a&&(a=r));if(l){t.splice(c--,1);var o=h();void 0!==o&&(e=o)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[i,h,r]},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};s.O.j=e=>0===t[e];var e=(e,i)=>{var h,r,[a,l,n]=i,o=0;if(a.some((e=>0!==t[e]))){for(h in l)s.o(l,h)&&(s.m[h]=l[h]);if(n)var c=n(s)}for(e&&e(i);o<a.length;o++)r=a[o],s.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return s.O(c)},i=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),s.O(void 0,[216],(()=>s(464)));var h=s.O(void 0,[216],(()=>s(204)));h=s.O(h)})();